sudo: required
language: python
cache: pip

services: 
  - docker

python:
  - "3.6"


install:
  - export $(cat /etc/os-release | grep "^ID=")
  - export $(cat /etc/os-release | grep "^VERSION_ID=" | sed "s/\"//" | sed "s/\"//")
  - distribution=$ID$($VERSION_ID/"//)
  - echo $distribution
  - curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
  - curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
  - apt-get update && apt-get install -y nvidia-container-toolkit
  - sudo systemctl restart docker

script:
  - docker run --gpus all nvidia/cuda:9.0-base nvidia-smi
